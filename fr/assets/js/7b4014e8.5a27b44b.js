"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[6544],{8453:(e,n,l)=>{l.d(n,{R:()=>o,x:()=>a});var s=l(6540);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},9822:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"data-management/workflow/native","title":"Workflows natifs","description":"Workflows de d\xe9ploiement int\xe9gr\xe9s.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/10-data-management/workflow/native.md","sourceDirName":"10-data-management/workflow","slug":"/data-management/workflow/native","permalink":"/fr/docs/data-management/workflow/native","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1769113845000,"sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Workflows natifs"},"sidebar":"tutorialSidebar","previous":{"title":"dvs workflow validate","permalink":"/fr/docs/data-management/workflow/validate"},"next":{"title":"dvs pull \ud83d\udd10","permalink":"/fr/docs/data-management/pull"}}');var r=l(4848),i=l(8453);const o={sidebar_position:8,title:"Workflows natifs"},a="Workflows natifs",t={},d=[{value:"deploy",id:"deploy",level:2},{value:"deploy-atomic",id:"deploy-atomic",level:2},{value:"deploy-git-pull",id:"deploy-git-pull",level:2},{value:"R\xe9f\xe9rence",id:"r\xe9f\xe9rence",level:2},{value:"deploy.yml",id:"deployyml",level:3},{value:"deploy-atomic.yml",id:"deploy-atomicyml",level:3},{value:"deploy-git-pull.yml",id:"deploy-git-pullyml",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"workflows-natifs",children:"Workflows natifs"})}),"\n",(0,r.jsx)(n.p,{children:"Workflows de d\xe9ploiement int\xe9gr\xe9s."}),"\n",(0,r.jsx)(n.h2,{id:"deploy",children:"deploy"}),"\n",(0,r.jsx)(n.p,{children:"D\xe9ploiement standard bas\xe9 sur rsync."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"dvs deploy prod --workflow deploy\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\xc9tapes :"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Synchronisation des fichiers via rsync (sans suppression)"}),"\n",(0,r.jsx)(n.li,{children:"Vidage du cache applicatif"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Utiliser quand :"})," D\xe9ploiements simples, sync directe de fichiers"]}),"\n",(0,r.jsx)(n.h2,{id:"deploy-atomic",children:"deploy-atomic"}),"\n",(0,r.jsx)(n.p,{children:"D\xe9ploiement atomique avec r\xe9pertoires de release et switch de symlink."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"dvs deploy prod --workflow deploy-atomic\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\xc9tapes :"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Cr\xe9er un nouveau r\xe9pertoire de release"}),"\n",(0,r.jsx)(n.li,{children:"Synchroniser les fichiers vers la release"}),"\n",(0,r.jsx)(n.li,{children:"Ex\xe9cuter les commandes post-deploy"}),"\n",(0,r.jsx)(n.li,{children:"Basculer le symlink vers la nouvelle release"}),"\n",(0,r.jsx)(n.li,{children:"Nettoyer les anciennes releases"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Utiliser quand :"})," D\xe9ploiements zero-downtime, rollback facile"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Structure de r\xe9pertoire :"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"/var/www/myapp/\n\u251c\u2500\u2500 current -> releases/20250108-143052\n\u251c\u2500\u2500 releases/\n\u2502   \u251c\u2500\u2500 20250108-143052/\n\u2502   \u251c\u2500\u2500 20250107-091500/\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 shared/\n    \u251c\u2500\u2500 uploads/\n    \u2514\u2500\u2500 .env\n"})}),"\n",(0,r.jsx)(n.h2,{id:"deploy-git-pull",children:"deploy-git-pull"}),"\n",(0,r.jsx)(n.p,{children:"D\xe9ploiement bas\xe9 sur Git via pull distant."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"dvs deploy prod --workflow deploy-git-pull\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\xc9tapes :"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"SSH vers le remote"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"git fetch origin"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"git reset --hard origin/main"})}),"\n",(0,r.jsx)(n.li,{children:"Ex\xe9cuter les commandes post-deploy"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Utiliser quand :"})," Workflow bas\xe9 sur Git, le remote a acc\xe8s au repo"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"r\xe9f\xe9rence",children:"R\xe9f\xe9rence"}),"\n",(0,r.jsx)(n.h3,{id:"deployyml",children:"deploy.yml"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"name: deploy\ndescription: Standard deployment with file sync\n\nrequires:\n  components: [files]\n\nparameters:\n  include_database:\n    default: false\n    description: Also deploy database (disabled for e-commerce by default)\n\nsteps:\n  - action: component.files.push\n\n  - action: component.database.push\n    when: $include_database || component.database.empty\n"})}),"\n",(0,r.jsx)(n.h3,{id:"deploy-atomicyml",children:"deploy-atomic.yml"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'name: deploy-atomic\ndescription: Zero-downtime deployment with symlinks and rollback\n\nrequires:\n  transport: ssh\n  components: [files]\n\nparameters:\n  releases_keep:\n    default: 5\n    description: Number of releases to keep\n  shared_folders:\n    default: ""\n    description: Comma-separated list of shared folders (relative to webroot)\n  current_link:\n    default: current\n    description: Name of the symlink pointing to current release\n\nsteps:\n  - action: ssh.create_release_dir\n\n  - action: component.files.push\n    target: $RELEASE_DIR\n\n  - action: ssh.link_shared_folders\n    folders: $shared_folders\n    when: $shared_folders\n\n  - action: ssh.switch_symlink\n    link: $current_link\n    target: $RELEASE_DIR\n\n  - action: ssh.cleanup_releases\n    keep: $releases_keep\n'})}),"\n",(0,r.jsx)(n.h3,{id:"deploy-git-pullyml",children:"deploy-git-pull.yml"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'name: deploy-git-pull\ndescription: Deploy by pulling latest code from git repository on remote\n\nrequires:\n  transport: ssh\n  components: [files]\n\nparameters:\n  branch:\n    default: main\n    description: Git branch to pull\n  include_database:\n    default: false\n    description: Also deploy database (disabled for e-commerce by default)\n  composer_install:\n    default: true\n    description: Run composer install after git pull\n  cache_clear:\n    default: true\n    description: Clear application cache after deployment\n\nsteps:\n  - action: ssh.run\n    command: "cd $REMOTE_PATH && git fetch origin && git pull origin $branch"\n    description: Pull latest code from git repository\n\n  - action: ssh.run\n    command: "cd $REMOTE_PATH && composer install --no-dev --optimize-autoloader"\n    when: $composer_install\n    description: Install PHP dependencies with composer\n\n  - action: ssh.run\n    command: "cd $REMOTE_PATH && php artisan cache:clear 2>/dev/null || rm -rf var/cache/* app/cache/* cache/* 2>/dev/null || true"\n    when: $cache_clear\n    description: Clear application cache\n\n  - action: component.database.push\n    when: $include_database || component.database.empty\n    description: Push database to remote\n'})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);