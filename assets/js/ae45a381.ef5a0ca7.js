"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[2377],{8445:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"data-management/secrets","title":"dvs secrets \ud83d\udd10","description":"Manage secrets for storage, remote, and workflow configurations.","source":"@site/docs/10-data-management/secrets.md","sourceDirName":"10-data-management","slug":"/data-management/secrets","permalink":"/docs/data-management/secrets","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1768811275000,"sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"dvs secrets \ud83d\udd10"},"sidebar":"tutorialSidebar","previous":{"title":"dvs dumps \ud83d\udd10","permalink":"/docs/data-management/dumps"},"next":{"title":"Guides","permalink":"/docs/guides/"}}');var t=n(4848),i=n(8453);const c={sidebar_position:9,title:"dvs secrets \ud83d\udd10"},d="dvs secrets",l={},o=[{value:"Concept",id:"concept",level:2},{value:"Contexts",id:"contexts",level:2},{value:"Resolution Order",id:"resolution-order",level:3},{value:"Commands",id:"commands",level:2},{value:"Examples",id:"examples",level:2},{value:"App Secrets (in app context)",id:"app-secrets-in-app-context",level:3},{value:"Global Secrets",id:"global-secrets",level:3},{value:"Using Secrets",id:"using-secrets",level:2},{value:"In Storage Configuration",id:"in-storage-configuration",level:3},{value:"In Remote Configuration",id:"in-remote-configuration",level:3},{value:"In Workflows",id:"in-workflows",level:3},{value:"Automatic Storage",id:"automatic-storage",level:2},{value:"File Format",id:"file-format",level:2},{value:"Security",id:"security",level:2}];function a(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"dvs-secrets",children:"dvs secrets"})}),"\n",(0,t.jsx)(s.p,{children:"Manage secrets for storage, remote, and workflow configurations."}),"\n",(0,t.jsx)(s.h2,{id:"concept",children:"Concept"}),"\n",(0,t.jsx)(s.p,{children:"Store sensitive values (passwords, API keys) separately from configuration:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Stored in ",(0,t.jsx)(s.code,{children:".env"})," format files with restricted permissions"]}),"\n",(0,t.jsxs)(s.li,{children:["Referenced in configs with ",(0,t.jsx)(s.code,{children:"${secrets:KEY}"})," syntax"]}),"\n",(0,t.jsx)(s.li,{children:"Automatically resolved at runtime"}),"\n",(0,t.jsx)(s.li,{children:"Never committed to version control"}),"\n"]}),"\n",(0,t.jsxs)(s.admonition,{title:"Git Exclusion",type:"warning",children:[(0,t.jsxs)(s.p,{children:["App secrets for remotes are stored in ",(0,t.jsx)(s.code,{children:"<app-dir>/.dvs/secrets/"}),". Make sure this folder is excluded from git:"]}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# .gitignore\n.dvs/secrets/\n"})}),(0,t.jsxs)(s.p,{children:["Global and storage secrets are stored in ",(0,t.jsx)(s.code,{children:"$DVS_CONFIG/"})," directory, which is outside your project and git by default."]})]}),"\n",(0,t.jsx)(s.h2,{id:"contexts",children:"Contexts"}),"\n",(0,t.jsx)(s.p,{children:"Secrets can be stored at two levels:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Context"}),(0,t.jsx)(s.th,{children:"Storage Path"}),(0,t.jsx)(s.th,{children:"Use Case"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"App"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"$DVS_CONFIG/apps/<app>/secrets/deploy.env"})}),(0,t.jsx)(s.td,{children:"App-specific secrets"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Global"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"$DVS_CONFIG/secrets/global.env"})}),(0,t.jsx)(s.td,{children:"Shared across all apps"})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"resolution-order",children:"Resolution Order"}),"\n",(0,t.jsxs)(s.p,{children:["When resolving ",(0,t.jsx)(s.code,{children:"${secrets:KEY}"}),":"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Search in ",(0,t.jsx)(s.strong,{children:"app secrets"})," first (if in app context)"]}),"\n",(0,t.jsxs)(s.li,{children:["Fallback to ",(0,t.jsx)(s.strong,{children:"global secrets"})]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"This allows overriding global secrets per-app."}),"\n",(0,t.jsx)(s.h2,{id:"commands",children:"Commands"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Command"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"dvs secrets list [--global]"})}),(0,t.jsx)(s.td,{children:"List secret names"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"dvs secrets set [--global] <name> <value>"})}),(0,t.jsx)(s.td,{children:"Set a secret"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"dvs secrets delete [--global] <name>"})}),(0,t.jsx)(s.td,{children:"Delete a secret"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"dvs secrets edit [--global]"})}),(0,t.jsx)(s.td,{children:"Edit secrets file"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(s.h3,{id:"app-secrets-in-app-context",children:"App Secrets (in app context)"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'# Set app-specific secret\ndvs secrets set PROD_DB_PASSWORD "mysecretpassword"\n\n# List app secrets (names only, no values)\ndvs secrets list\n\n# Delete app secret\ndvs secrets delete PROD_DB_PASSWORD\n\n# Edit app secrets file\ndvs secrets edit\n'})}),"\n",(0,t.jsx)(s.h3,{id:"global-secrets",children:"Global Secrets"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'# Set global secret (shared across apps)\ndvs secrets set --global SLACK_WEBHOOK "https://hooks.slack.com/..."\n\n# List global secrets\ndvs secrets list --global\n\n# Edit global secrets\ndvs secrets edit --global\n'})}),"\n",(0,t.jsx)(s.h2,{id:"using-secrets",children:"Using Secrets"}),"\n",(0,t.jsxs)(s.p,{children:["Secrets use the syntax ",(0,t.jsx)(s.code,{children:"${secrets:KEY}"})," in configuration files."]}),"\n",(0,t.jsx)(s.h3,{id:"in-storage-configuration",children:"In Storage Configuration"}),"\n",(0,t.jsxs)(s.p,{children:["When running ",(0,t.jsx)(s.code,{children:"dvs storage add"}),", passwords are automatically stored as secrets:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"# $DVS_CONFIG/storages/backup.conf\n[default]\ntransport = sftp\nhost = backup.example.com\nuser = admin\npassword = ${secrets:STORAGE_BACKUP_PASS}\n"})}),"\n",(0,t.jsx)(s.h3,{id:"in-remote-configuration",children:"In Remote Configuration"}),"\n",(0,t.jsxs)(s.p,{children:["Same for ",(0,t.jsx)(s.code,{children:"dvs remote configure"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"# .dvs/remotes/prod.conf\n[database]\ndb_password = ${secrets:REMOTE_PROD_DB_PASS}\n"})}),"\n",(0,t.jsx)(s.h3,{id:"in-workflows",children:"In Workflows"}),"\n",(0,t.jsxs)(s.p,{children:["Access via ",(0,t.jsx)(s.code,{children:"${secrets.NAME}"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"steps:\n  - action: ssh.run\n    command: \"curl -X POST ${secrets.SLACK_WEBHOOK} -d 'Deploy complete'\"\n"})}),"\n",(0,t.jsx)(s.h2,{id:"automatic-storage",children:"Automatic Storage"}),"\n",(0,t.jsxs)(s.p,{children:["When using interactive commands (",(0,t.jsx)(s.code,{children:"dvs storage add"}),", ",(0,t.jsx)(s.code,{children:"dvs remote configure"}),"), sensitive values like passwords are:"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Automatically stored in the appropriate secrets file"}),"\n",(0,t.jsxs)(s.li,{children:["Replaced with ",(0,t.jsx)(s.code,{children:"${secrets:KEY}"})," reference in config"]}),"\n",(0,t.jsxs)(s.li,{children:["Key naming convention: ",(0,t.jsx)(s.code,{children:"STORAGE_<name>_<param>"})," or ",(0,t.jsx)(s.code,{children:"REMOTE_<name>_<param>"})]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Example:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"$ dvs storage add backup --type sftp\n# Enter password interactively\n# \u2192 Stored as STORAGE_BACKUP_PASS in global secrets\n# \u2192 Config contains: password = ${secrets:STORAGE_BACKUP_PASS}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"file-format",children:"File Format"}),"\n",(0,t.jsxs)(s.p,{children:["Secrets use simple ",(0,t.jsx)(s.code,{children:"KEY=value"})," format:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# $DVS_CONFIG/secrets/global.env\nSTORAGE_BACKUP_PASS=mysecretpassword\nSLACK_WEBHOOK=https://hooks.slack.com/xxx\n\n# $DVS_CONFIG/apps/myapp/secrets/deploy.env\nREMOTE_PROD_DB_PASS=dbpassword\nAPI_KEY=xyz789\n"})}),"\n",(0,t.jsx)(s.h2,{id:"security",children:"Security"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Files created with ",(0,t.jsx)(s.code,{children:"600"})," permissions (owner read/write only)"]}),"\n",(0,t.jsxs)(s.li,{children:["Directories created with ",(0,t.jsx)(s.code,{children:"700"})," permissions"]}),"\n",(0,t.jsx)(s.li,{children:"Values masked in command output"}),"\n",(0,t.jsxs)(s.li,{children:["Never stored in git (inside ",(0,t.jsx)(s.code,{children:"$DVS_CONFIG/"})," directory)"]}),"\n",(0,t.jsx)(s.li,{children:"Secrets resolved only at runtime, never written to config files"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>d});var r=n(6540);const t={},i=r.createContext(t);function c(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);