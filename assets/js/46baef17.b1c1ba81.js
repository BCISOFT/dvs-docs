"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[7415],{6571:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"data-management/backup/prune","title":"dvs backup prune","description":"Remove old snapshots according to retention policy.","source":"@site/docs/10-data-management/backup/prune.md","sourceDirName":"10-data-management/backup","slug":"/data-management/backup/prune","permalink":"/docs/data-management/backup/prune","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1768597279000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"dvs backup prune"},"sidebar":"tutorialSidebar","previous":{"title":"dvs backup restore","permalink":"/docs/data-management/backup/restore"},"next":{"title":"dvs backup delete","permalink":"/docs/data-management/backup/delete"}}');var d=t(4848),r=t(8453);const a={sidebar_position:5,title:"dvs backup prune"},c="dvs backup prune",l={},i=[{value:"Syntax",id:"syntax",level:2},{value:"Options",id:"options",level:2},{value:"Examples",id:"examples",level:2},{value:"Retention Policy",id:"retention-policy",level:2},{value:"Output",id:"output",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"dvs-backup-prune",children:"dvs backup prune"})}),"\n",(0,d.jsx)(n.p,{children:"Remove old snapshots according to retention policy."}),"\n",(0,d.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"dvs backup prune --storage <name> [options]\n"})}),"\n",(0,d.jsx)(n.h2,{id:"options",children:"Options"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Option"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--storage <name>"})}),(0,d.jsx)(n.td,{children:"Storage to prune (required)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--keep-last <n>"})}),(0,d.jsx)(n.td,{children:"Keep last n snapshots (default: 7)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--keep-daily <n>"})}),(0,d.jsx)(n.td,{children:"Keep n daily snapshots (default: 7)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--keep-weekly <n>"})}),(0,d.jsx)(n.td,{children:"Keep n weekly snapshots (default: 4)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--keep-monthly <n>"})}),(0,d.jsx)(n.td,{children:"Keep n monthly snapshots"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--global"})}),(0,d.jsx)(n.td,{children:"Prune all apps (in app context)"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# Default retention policy\ndvs backup prune --storage backup\n\n# Custom retention\ndvs backup prune --storage backup \\\n  --keep-last 5 \\\n  --keep-daily 7 \\\n  --keep-weekly 4 \\\n  --keep-monthly 6\n\n# Prune all apps\ndvs backup prune --storage backup --global\n"})}),"\n",(0,d.jsx)(n.h2,{id:"retention-policy",children:"Retention Policy"}),"\n",(0,d.jsx)(n.p,{children:"Restic keeps snapshots matching ANY of the criteria:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Policy"}),(0,d.jsx)(n.th,{children:"Keeps"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--keep-last 7"})}),(0,d.jsx)(n.td,{children:"7 most recent snapshots"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--keep-daily 7"})}),(0,d.jsx)(n.td,{children:"1 per day for 7 days"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--keep-weekly 4"})}),(0,d.jsx)(n.td,{children:"1 per week for 4 weeks"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"--keep-monthly 6"})}),(0,d.jsx)(n.td,{children:"1 per month for 6 months"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"output",children:"Output"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"Pruning snapshots...\n\nKeeping:\n  abc123de (2025-01-08) - latest\n  def456gh (2025-01-07) - daily\n  ...\n\nRemoving:\n  old123ab (2024-12-01)\n  old456cd (2024-11-15)\n\nFreed: 234 MB\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(o,{...e})}):o(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var s=t(6540);const d={},r=s.createContext(d);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);