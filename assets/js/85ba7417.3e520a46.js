"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9984],{3563:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"admin-commands/prune","title":"dvs prune","description":"Remove orphaned databases, users, and app configurations.","source":"@site/docs/04-admin-commands/prune.md","sourceDirName":"04-admin-commands","slug":"/admin-commands/prune","permalink":"/docs/admin-commands/prune","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1764278410000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"dvs poweron","permalink":"/docs/admin-commands/poweron"},"next":{"title":"dvs recipes","permalink":"/docs/admin-commands/recipes"}}');var a=s(4848),d=s(8453);const i={},t="dvs prune",o={},l=[{value:"Description",id:"description",level:2},{value:"Usage",id:"usage",level:2},{value:"Options",id:"options",level:3},{value:"Important Notes",id:"important-notes",level:2},{value:"Examples",id:"examples",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Dry-run Mode",id:"dry-run-mode",level:3},{value:"Related Commands",id:"related-commands",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"dvs-prune",children:"dvs prune"})}),"\n",(0,a.jsx)(n.p,{children:"Remove orphaned databases, users, and app configurations."}),"\n",(0,a.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"prune"})," command identifies and removes orphaned resources that are no longer referenced by valid applications:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Orphaned MySQL/MariaDB databases"}),": Databases that are not referenced by any installed application"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Orphaned SQL users"}),": MySQL/MariaDB database users that are not referenced by any installed application"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Orphaned app configurations"}),": App configuration directories whose ",(0,a.jsx)(n.code,{children:"APP_ROOT"})," or ",(0,a.jsx)(n.code,{children:"APP_WEB_ROOT"})," directories no longer exist"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The command analyzes all app configurations and verifies that directories exist. Only apps with valid configurations and existing directories are considered valid."}),"\n",(0,a.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dvs prune [--dry-run]\n"})}),"\n",(0,a.jsx)(n.h3,{id:"options",children:"Options"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"--dry-run"}),": Display what would be deleted without actually deleting anything or prompting for confirmation. Useful for previewing the results before running the actual prune command."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"important-notes",children:"Important Notes"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Interactive"}),": The command allows you to select which resources to delete using a multiple choice interface (unless ",(0,a.jsx)(n.code,{children:"--dry-run"})," is used)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Selective"}),": You can choose to delete all resources at once or select specific ones individually"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Safe"}),": Only resources not referenced by valid apps are shown for deletion"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Service Management"}),": The command automatically starts MySQL/MariaDB services if they are not running"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Dry-run Mode"}),": Use ",(0,a.jsx)(n.code,{children:"--dry-run"})," to preview what would be deleted without making any changes"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,a.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"$ dvs prune\n\nPrune Analysis:\n\nOrphaned databases:\n  - old_app_db\n  - test_db\n\nOrphaned SQL users:\n  - old_app_user\n  - test_user\n\nSelect resources to delete (space to toggle, enter to confirm):\n  [\u2713] All\n  [ ] app:pipobimbo\n  [ ] db:old_app_db\n  [ ] db:test_db\n  [ ] user:old_app_user\n  [ ] user:test_user\n  [ ] Cancel\n\nDeleting orphaned resources...\nDeleting database old_app_db ... \u2714\nDeleting database test_db ... \u2714\nDeleting user old_app_user ... \u2714\nDeleting user test_user ... \u2714\n\nPrune completed.\n"})}),"\n",(0,a.jsx)(n.h3,{id:"dry-run-mode",children:"Dry-run Mode"}),"\n",(0,a.jsx)(n.p,{children:"Preview what would be deleted without making any changes:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"$ dvs prune --dry-run\n\nPrune Analysis:\n\nOrphaned databases:\n  - old_app_db (from mysql-8.0)\n  - test_db (from mysql-8.0)\n\nOrphaned SQL users:\n  - old_app_user (from mysql-8.0)\n  - test_user (from mysql-8.0)\n\nDry-run mode: The following resources would be deleted:\n\nOrphaned databases:\n  - old_app_db (from mysql-8.0)\n  - test_db (from mysql-8.0)\n\nOrphaned SQL users:\n  - old_app_user (from mysql-8.0)\n  - test_user (from mysql-8.0)\n\nNo changes were made (dry-run mode).\n"})}),"\n",(0,a.jsx)(n.h2,{id:"related-commands",children:"Related Commands"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"dvs mysqlconsole"})," - Root access to MySQL/MariaDB"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"dvs status"})," - List services and applications with their status"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>t});var r=s(6540);const a={},d=r.createContext(a);function i(e){const n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);